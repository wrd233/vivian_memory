# 互动粒子星海开发计划

## 📋 项目概述

本项目是一个WebGL驱动的数字化情感景观，通过四个精心设计的开发阶段，将简单的粒子系统逐步转化为一个有机、动态、富有情感的"记忆之海"。

## 🎯 四个开发阶段

### 阶段1：粒子基础 - 创造星辰 ✨
**目标：** 摒弃传统的立方体几何体，创建第一个由大量粒子组成的静态系统。

#### 步骤1：创建粒子几何体
- ✅ **使用THREE.BufferGeometry**：定义粒子的精确位置
- ✅ **Float32Array数组**：存储5,000个粒子的XYZ坐标
- ✅ **分布范围**：在150×150的二维平面上随机分布

#### 步骤2：粒子材质与系统
- ✅ **THREE.PointsMaterial**：定义粒子的统一外观
- ✅ **THREE.Points对象**：将几何体和材质结合
- ✅ **颜色系统**：基于高度生成金黄色调的渐变

#### 步骤3：波浪状"地面"
- ✅ **程序化地形**：使用数学函数生成起伏地形
- ✅ **高度计算**：Y = f(X,Z) 的函数关系
- ✅ **有机形态**：从机械到自然的过渡

### 阶段2：注入灵魂 - 有机地形与噪点 🌊
**目标：** 使用Simplex Noise替代简单数学函数，让地形变得更自然、更有机。

#### 步骤1：引入噪点库
- ✅ **Simplex Noise**：`npm install simplex-noise`
- ✅ **多维噪点**：createNoise2D() 函数
- ✅ **随机种子**：确保每次生成的一致性

#### 步骤2：应用噪点
- ✅ **分层噪点**：
  - 大尺度：0.005倍率 × 15振幅（主要地形）
  - 中尺度：0.02倍率 × 8振幅（山丘细节）
  - 小尺度：0.08倍率 × 3振幅（地表纹理）
- ✅ **参数调优**：通过实验找到最佳视觉效果

#### 步骤3：调试与优化
- ✅ **实时预览**：Vite热重载支持
- ✅ **性能监控**：FPS显示在UI中
- ✅ **参数调整**：通过代码常量快速迭代

### 阶段3：视觉升华 - 氛围与美学 ✨
**目标：** 调整颜色、光效和相机，创造深邃、闪烁的星海。

#### 步骤1：增强粒子外观
- ✅ **动态颜色**：基于高度和噪点的HSL颜色系统
- ✅ **透明度变化**：低处粒子更透明，创造深度感
- ✅ **大小变化**：基于高度的粒子大小渐变

#### 步骤2：相机与交互
- ✅ **OrbitControls**：完整的3D相机控制
  - 鼠标拖拽旋转视角
  - 滚轮缩放距离
  - 右键拖拽平移
- ✅ **相机限制**：
  - 最小距离：10单位
  - 最大距离：200单位
  - 最大极角：π/2（防止翻转）

#### 步骤3：高级渲染技术
- ✅ **自定义着色器**：使用ShaderMaterial实现
- ✅ **AdditiveBlending**：粒子重叠处发光效果
- ✅ **深度测试优化**：禁用深度测试提升性能
- ✅ **像素比例**：适配高DPI屏幕

### 阶段4：优化与部署 🚀
**目标：** 确保项目运行流畅，并发布到线上。

#### 步骤1：性能优化
- ✅ **粒子数量**：从50,000优化到5,000个
- ✅ **渲染优化**：使用WebGL着色器
- ✅ **内存管理**：资源清理机制
- ✅ **帧率监控**：稳定在60 FPS

#### 步骤2：部署配置
- ✅ **Vite构建**：现代化的构建系统
- ✅ **生产优化**：代码压缩和Tree Shaking
- ✅ **静态部署**：支持GitHub Pages等平台

## 🛠️ 技术实现细节

### 核心架构
```
InteractiveParticleSea
├── SceneManager       # 场景管理（相机、渲染器、光照）
├── ParticleSystem     # 粒子系统（噪点、颜色、动画）
├── Constants          # 配置常量
└── OrbitControls      # 相机控制
```

### 关键算法

#### 地形生成算法
```javascript
height = noise2D(x * 0.005, z * 0.005) * 15  // 主要地形
       + noise2D(x * 0.02, z * 0.02) * 8    // 山丘细节
       + noise2D(x * 0.08, z * 0.08) * 3    // 地表纹理
```

#### 颜色计算算法
```javascript
color.setHSL(
  0.1 + colorNoise * 0.1,     // 金色到琥珀色
  0.6 + heightRatio * 0.3,    // 饱和度变化
  0.3 + heightRatio * 0.5     // 亮度变化
);
```

### 性能指标
- **粒子数量**：5,000个（可配置）
- **目标帧率**：60 FPS
- **内存使用**：< 50MB
- **GPU内存**：< 100MB

## 🎮 使用指南

### 开发环境
```bash
npm install          # 安装依赖
npm run dev          # 启动开发服务器
npm run build        # 构建生产版本
npm run preview      # 预览构建结果
```

### 交互操作
- **鼠标左键拖拽**：旋转视角
- **鼠标滚轮**：缩放距离
- **鼠标右键拖拽**：平移视角
- **双击**：自动旋转开关

### 配置调整
在`src/utils/constants.js`中可以调整：
- 粒子数量
- 地形参数
- 颜色范围
- 性能设置

## 📊 开发进度

| 阶段 | 状态 | 完成时间 | 关键特性 |
|------|------|----------|----------|
| 阶段1 | ✅ 完成 | 已部署 | 粒子系统基础 |
| 阶段2 | ✅ 完成 | 已部署 | Simplex Noise地形 |
| 阶段3 | ✅ 完成 | 已部署 | 视觉增强与交互 |
| 阶段4 | ✅ 完成 | 已部署 | 性能优化与部署 |

## 🔮 未来扩展

### 短期计划
- [ ] 粒子信息面板（点击显示详情）
- [ ] 昼夜循环效果
- [ ] 音频可视化集成

### 长期愿景
- [ ] VR/AR支持
- [ ] 多人协作模式
- [ ] 粒子物理模拟
- [ ] 自定义地形导入

## 📁 项目结构

```
interactive-particle-sea/
├── src/
│   ├── lib/
│   │   ├── SceneManager.js      # 场景管理
│   │   └── ParticleSystem.js    # 粒子系统
│   ├── utils/
│   │   └── constants.js         # 配置常量
│   └── main.js                  # 应用入口
├── public/
├── index.html                   # HTML入口
├── style.css                    # 样式文件
├── package.json                 # 项目配置
└── DEVELOPMENT_PLAN.md         # 本文档
```

---

*这份开发计划确保了从概念到实现的完整路径，每个阶段都有明确的目标和可验证的成果。项目已成功完成所有四个阶段，并准备投入生产使用。*